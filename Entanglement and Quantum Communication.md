# Bell Inequalities
## Entanglement and Anti-Correlation
As a preliminary, we consider some properties of one of the Bell basis states, $\frac{\ket{01} - \ket{10}}{\sqrt{2}}$. Up to a global phase factor, this state takes on the same form in any orthonormal basis (if the same basis is used for both qubits). That is, let $\ket{x}, \ket{y}$ be some other orthonormal basis; then there exists a unitary change-of-basis matrix $U$ with $\ket{0} = U\ket{x}, \ket{1} = U\ket{y}$. In other words $\ket{0} = a\ket{x} + b\ket{y}, \ket{1} = c\ket{x} + d\ket{y}$ where $a^2 + c^2 = 1, b^2 + d^2 = 1$, and $ab + cd = 0$. Then $\ket{01} = (a\ket{x} + b\ket{y})(c\ket{x} + d\ket{y}) = ac\ket{xx} + ad\ket{xy} + bc\ket{yx} + bd\ket{yy}$ and $\ket{10} = (c\ket{x} + d\ket{y})(a\ket{x} + b\ket{y}) = ac\ket{xx} + bc\ket{xy} + ad\ket{yx} + bd\ket{yy}$; thus $\ket{01} - \ket{10} = (ad - bc)\ket{xy} + (bc - ad)\ket{yx} = (ad - bc)(\ket{xy} - \ket{yx}) = \ket{xy} - \ket{yx}$, up to a global phase factor since $ad - bc = \det(U)$ which must be a complex number with norm $1$, since $U$ is unitary, and so the Bell state above is just $\frac{\ket{xy} - \ket{yx}}{\sqrt{2}}$ in the $\ket{x}, \ket{y}$ basis. 

An upshot of this is that, if you measure any observable $M$, say with two possible results $1$ and $-1$, on the first qubit, you will get a $1$ with probability $1/2$ and a $-1$ with probability $1/2$, and measuring the same observable on the second qubit will always give you the opposite result of what you measured on the first. (After all, any single-qubit observable with measurement outcomes $1, -1$ will have an orthonormal basis of eigenvector $\ket{x}, \ket{y}$ corresponding to the two measurement outcomes; since the Bell state in this basis is $\frac{\ket{xy} - \ket{yx}}{\sqrt{2}}$, measuring the first qubit either gets you $1$ and collapses the state into $\ket{xy}$, ensuring a measurement of $-1$ on the second qubit, or the other way around.)

## CHSH Game
Consider the following game: Eve chooses two bits uniformly and independently at random, $x$ and $y$, and sends them to Alice and Bob respectively. Alice and Bob must, without any possibility of communication after they learn $x$ and $y$ (though they can decide on a strategy beforehand), choose bits $a, b$ such that $a$ XOR $b$ = $x$ AND $y$. If they decide beforehand that, say, Alice should send $a = 1$, and Bob should send $b = 1$, regardless of what $x$ and $y$ are, they can win the game with probability $0.75$, since $x$ AND $y$ has a 75% chance of being $0$ and, under this strategy, $a$ XOR $b$ will always be $0$. Indeed any of the deterministic strategies (there are only finitely many, which can be checked by hand) will fail on at least one of the inputs. Letting $a_0, a_1, b_0, b_1$ be Alice and Bob's choices of bits when they receive a $0$ or a $1$, if we want to succeed for all inputs with a deterministic strategy we need $a_0 = b_0, a_0 = b_1, a_1 = b_0, a_1 \neq b_1$; but the first three equations put together imply $a_1 = b_1$, contradicting the last. Furthermore, no probabilistic strategy can do better than this. Any probabilistic strategy can be rephrased in terms of choosing between deterministic strategies $s_1, \dots, s_n$ at random with probabilities $p(s_1), \dots, p(s_n)$. Letting $p(i)$ be the probability of winning with strategy $i$, we have that the total probability of winning is $p(s_1)p(1) + \dots + p(s_n)p(n) \leq 0.75p(s_1) + \dots + 0.75p(s_n) = 0.75$, same as the best deterministic strategy. 

A quantum strategy, which can beat the deterministic strategy, uses the Bell state $\frac{\ket{00} + \ket{11}}{\sqrt{2}}$. Like the state analyzed above this takes on the same form in any orthonormal basis. In the strategy, Alice will need to measure in the computational basis and $\ket{+}, \ket{-}$ basis; Bob will need to measure in the "$\ket{\pi/8}, \ket{5\pi/8}$ basis" (say the $B_0$ basis for the future) given by $\cos(\pi/8)\ket{0} + \sin(\pi/8)\ket{1}, \cos(5\pi/8)\ket{0} + \sin(5\pi/8)\ket{1}$ and the "$\ket{-\pi/8}, \ket{3\pi/8}$ basis", (say $B_1$) which has the same form as above but with $\pi/8$ replaced with $-\pi/8$ and $5\pi/8$ replaced with $3\pi/8$. Now we give the strategy for each possible input; in all cases Alice measures before Bob.

When $x = 0$ Alice measures in the standard basis and sends her result; when $x = 1$ she instead measures in the $\ket{+}, \ket{-}$ basis and sends $0$ if she gets a $\ket{+}$ and $1$ otherwise. (The same will apply for Bob--send a $0$ if he gets the first element of his basis and a $1$ if he gets the other. )

When $y = 0$ Bob measures in the $\ket{\pi/8}, \ket{5\pi/8}$ basis and chooses his bit accordingly; when $y = 1$ he does the same for the $\ket{-\pi/8}, \ket{3\pi/8}$ basis instead. 

We will find that, in each case, the probability of winning is $\cos^2(\pi/8)$, which is therefore Alice and Bob's overall probability of winning. 

Suppose first that $x = y = 0$; Alice and Bob want to send identical bits. Alice will send a $0$ or $1$ with equal probability. In the first case Bob's qubit ends up in the state $\ket{0}$, and he measures in the $B_0$ basis; he will send a $0$ with probability $|\bra{0}\ket{\pi/8}|^2 = |\cos(\pi/8)|^2$. In the second his qubit ends up in $\ket{1}$, and he sends a $1$ with probability $|\bra{1}\ket{5\pi/8}|^2 = |\sin(5\pi/8)|^2 = |\cos(\pi/8)|^2$ (using the phase shift identity). Thus they win with probability $|\cos(\pi/8)|^2$ in this case. 

Suppose instead that $x = 1, y = 0$. As before Alice gets $\ket{+}, \ket{-}$ with equal probability, sending a $0$ or $1$ accordingly, and Bob wants to send the same bit. In the first case Bob's qubit is in the state $\ket{+}$ and he measures in the $B_0$ basis, sending a $0$ with probability $|\bra{+}\ket{\pi/8}|^2 = |\frac{1}{\sqrt{2}}(\bra{0}\ket{\pi/8} + \bra{1}\ket{\pi/8}|^2 = |\frac{1}{\sqrt{2}}\cos(\pi/8) + \frac{1}{\sqrt{2}}\sin(\pi/8)|^2$. Recall that the expression inside the absolute value sign can be written in the form $A\cos(\pi/8 + \phi)$ with amplitude $A = \sqrt{(1/\sqrt{2})^2 + (1/\sqrt{2})^2} = 1$ and phase shift $\phi = \arctan(\frac{-1/\sqrt{2}}{1/\sqrt{2}}) = \arctan(-1) = -\pi/4$, so we get $|\cos(\pi/8 - \pi/4)|^2 = |\cos(-\pi/8)|^2 = \cos(\pi/8)^2$. If Alice measures a $\ket{-}$ and so sends a $1$, the probability that Bob sends a $1$ will be $|\bra{-}\ket{5\pi/8}|^2 = |\frac{1}{\sqrt{2}}\cos(5\pi/8) - \frac{1}{\sqrt{2}}\sin(5\pi/8)|^2 = |\frac{1}{\sqrt{2}}\sin(\pi/8) - \frac{1}{\sqrt{2}}\cos(9\pi/8)|^2$ = $|\frac{1}{\sqrt{2}}\sin(\pi/8) + \frac{1}{\sqrt{2}}\cos(\pi/8)|^2$; thus we're back where we started and get a probability of $\cos^2(\pi/8)$ as before. The case $x = 0, y = 1$ is similar. 

Finally we have the case $x = 1, y = 1$ where Alice and Bob instead want to send opposite bits. Alice measures in the $\ket{+}, \ket{-}$ basis, sending a $0$ or $1$ with equal probability. In the first case Bob measures his state (now equal to $\ket{+}$) in the $B_1$ basis, hopefully getting a $\ket{3\pi/8}$ so that he sends a $1$. This happens with probability $|\bra{+}\ket{3\pi/8}|^2 = |\frac{1}{\sqrt{2}}\cos(3\pi/8) + \frac{1}{\sqrt{2}}\sin(3\pi/8)|^2$ = $|\frac{1}{\sqrt{2}}(\cos(3\pi/8) + \cos(\pi/8))|^2 = |\frac{1}{\sqrt{2}}2\cos(\pi/4)\cos(\pi/8)|^2 = |\frac{2}{\sqrt{2}}\frac{\sqrt{2}}{2}\cos(\pi/8)|^2 = \cos^2(\pi/8)$. A similar computation shows that the win probability when Alice measures a $\ket{-}$, namely $|\bra{-}\ket{-\pi/8}|^2$, is also $\cos^2(\pi/8)$. 

Thus in each individual case (and so for the game as a whole) the strategy wins with probability $\cos^2(\pi/8)$, or about $0.85$, higher than the maximum of $0.75$ from the classical case. 

There is an alternate version of the CHSH inequality, phrased using expectations instead of probabilities, which fits better with Tsirelson's inequality (proved below); the setup for the version also makes it clearer how the assumptions of locality and realism lead to the Bell inequality. Say we have some procedure for creating particles with "properties" $p, q, r, s$; a particle either has or doesn't have each property, and we define measurements $P, Q, R, S$ such that $P = 1$ if the particle has property $p$, $P = -1$ otherwise, and the same for the other measurements.

Suppose we create a pair of such particles according to some procedure and send one to Alice and one to Bob. Alice chooses to measure either $P$ or $Q$ on her particle, and Bob measures $R$ or $S$ on his, in such a way that the measurements do not affect each other (e.g. they are performed at the same time far enough away that speed-of-light delay prevents any causal influence). If we use the same procedure to create and send many pairs of particles it makes sense to talk about the probabilities of different values of $P, Q,$ etc. as well as probabilities and expectations of random variables created from the measurements, like $PR$ or $QS$. (Since we never measure both $P$ and $Q$ -- Alice picks just one of those two to measure, a random variable like $PQ$ wouldn't make sense, but we won't need to deal with those.) In particular we will consider the random variable $PR + QR + QS - PS = (P + Q)R + (Q - P)S$. Regardless of the values of $P, Q$, one of $P + Q$, $Q - P$ is $0$ and the other has absolute value $2$, so the random variable as a whole always has absolute value $2$. If we consider the expectation $E(PR + QR + QS - PS)$ it is therefore at most $2$, since it is a mixture of outcomes that are either $-2$ or $2$. By linearity of expectations we then have $E(PR) + E(QR) + E(QS) - E(PS) \leq 2$. 

Now suppose that the particles are prepared in the Bell state $B_{11} = \frac{\ket{01} - \ket{10}}{\sqrt{2}}$. Let $P, Q$ be the observables $Z, X$ on Alice's qubit (measuring in the computational basis and the $\ket{+}, \ket{-}$ basis) and let $R, S$ be the observables $\frac{-Z - X}{\sqrt{2}}, \frac{Z - X}{\sqrt{2}}$ on Bob's qubit. Then we find that all the expectations from the CHSH inequality are each $\frac{1}{\sqrt{2}}$, except $E(PS)$ which is $\frac{-1}{\sqrt{2}}$, and so $E(PR) + E(QR) + E(QS) - E(PS) = \frac{4}{\sqrt{2}} = 2\sqrt{2}$, violating the bound of $2$ in the CHSH inequality. 
## Tsirelson's Inequality
On the other hand we have that, for any observables $P, Q$, both with outcomes $1, -1$, on one qubit and $R, S$ on the other qubit, $E(PR) + E(QR) + E(QS) - E(PS) \leq 2\sqrt{2}$, with equality obtained by the observables in the section above. Note first that $P^2 = I$, and the same for all the other observables, since in some basis each observable has the matrix diag(1, -1) which clearly squares to $I$. Now (representing the tensor product by juxtaposition in what follows for the sake of brevity) consider $(PR + QR + QS - PS)^2$. This expands out to 16 terms, which we'll put into a few groups. The first group consists of $(PR)^2, (QR)^2, (QS)^2, (-PS)^2$. Note that $(PR)^2 = P^2R^2$ (don't forget that this is really $(P \otimes R)^2$) which in turn equals $I$, and the same for all the other terms. Thus the fully expanded form of the expression from before includes $4I$. The second group consists of $PQR^2, -P^2RS, QPR^2, Q^2RS, Q^2SR, -QPS^2, -P^2SR, -PQS^2$. Since the squares of all the operators involved are $I$, this reduces down to $PQ, -RS, QP, RS, SR, -QP, -SR, -PQ$. These all cancel out, since for each term its negation is also present. Finally we have the terms where all $4$ observables are involved: $PQRS, -QPRS, -PQSR, QPRS$. The sum of these terms is equal to $[P, Q] \otimes [R, S] = (PQ - QP)(RS - SR) = PQRS - QPRS - PQSR + QPSR$. Putting this all together we have $$(PR + QR + QS - PS)^2 = 4I + [P, Q] \otimes [R, S]$$ Thus $E(PR + QR + QS - PS) = \sqrt{(E(4I + [P, Q] \otimes [R, S]))}$  
# Quantum Teleportation
Using 1 pair of entangled qubits and 2 classical bits it is possible to send a qubit. Suppose Alice has a qubit $M$ in some state $a\ket{0} + b\ket{1}$; note that Alice does not need to know the amplitudes in order for this to work, and in fact the procedure works the same regardless of what qubit is to be sent. Suppose also that, at some prior time, Alice and Bob put the qubits $A$ and $B$ in the Bell state $\ket{\beta_{00}} = \frac{\ket{00} + \ket{11}}{\sqrt{2}}$ (this could be accomplished by applying a Hadamard gate to $A$ and then a CNOT to both, with $A$ as the control and $B$ as the target) and then gave $A$ to Alice and $B$ to Bob. 

The basic idea is that, by messing with the qubits she has ($M$ and $A$) in a certain way, Alice can put the whole system into a superposition of 4 states, one for each 2-bit string; each of these will have $B$ be a slight modification of $M$. Then Alice can measure to collapse everything to just one of those four branches; she then knows which of the four modified versions of $M$ Bob has, and can send him two classical bits to indicate which one. Then Bob can perform one of four operations on $B$ to turn it into $A$.

In more detail:

1) At the start, the whole 3-qubit system is in the state $(a\ket{0} + b\ket{1})(\ket{\beta_{00}} = (a\ket{0} + b\ket{1})(\frac{\ket{00} + \ket{11}}{\sqrt{2}}) = \frac{1}{\sqrt{2}}a\ket{0}(\ket{00} + \ket{11}) + \frac{1}{\sqrt{2}}b\ket{1}(\ket{00} + \ket{11})$. 
2) If Alice applies a CNOT to $M$ and $A$, with $M$ as the control and $A$ as the target, this becomes $\frac{1}{\sqrt{2}}a\ket{0}(\ket{00} + \ket{11}) + \frac{1}{\sqrt{2}}b\ket{1}(\ket{10} + \ket{01})$ -- now the $b\ket{1}$ "branch" of the system's state has a different Bell state "attached" to it. 
3) If Alice then applies a Hadamard gate to $M$, we get $\frac{1}{2}a\ket{0}(\ket{00} + \ket{11}) + \frac{1}{2}a\ket{1}(\ket{00} + \ket{11}) + \frac{1}{2}b\ket{0}(\ket{10} + \ket{01}) - \frac{1}{2}b\ket{1}(\ket{10} + \ket{01})$. Distributing and rearranging things turns this into $\frac{1}{2}[\ket{00}a\ket{0} + \ket{00}b\ket{1} + \ket{01}a\ket{1} + \ket{01}b\ket{0} + \ket{10}a\ket{0} - \ket{10}b\ket{1} + \ket{11}a\ket{1} - \ket{11}b\ket{0}]$ or $$\frac{1}{2}[\ket{00}(a\ket{0} + b\ket{1}) + \ket{01}(b\ket{0} + a\ket{1}) + \ket{10}(a\ket{0} - b\ket{1}) + \ket{11}(b\ket{0} - a\ket{1})]$$ 
4) If Alice then measures her qubits, $B$ ends up in one of four possible states. If she measures $\ket{00}$, then B is already in M's starting state. If $\ket{01}$, then applying a NOT gate, i.e. the Pauli $X$ matrix, to $B$ recovers $M$. If $\ket{10}$, then applying a $Z$ matrix recovers $M$. Finally, if $\ket{11}$, then applying a $Z$ matrix turns it into $b\ket{0} + a\ket{1}$, and from there, applying $X$ recovers $M$. Thus Alice need only tell Bob her measurement result and he can apply one of those four operations. 
5) More formally and compactly, if $i$ is the result of measuring $M$ and $j$ is the result of measuring $A$, then Bob needs to apply $Z$ first if and only if $j = 1$, and $X$ if and only if $i = 1$. Thus Alice sends $i$ and $j$ to Bob, who then applies $X^iZ^j$ to $B$. 
Without the classical bits, Bob will have no idea what to do to $B$, and so can't expect to recover $M$. In fact, without the classical bits, no matter how Bob measures $B$, he will be unable to tell whether Alice has done anything on her end (proof later). Note also that this does not violate the no-cloning theorem because, while $B$ does end up being a "copy" of $M$ in some sense, we have to measure $M$ to make the protocol work, which will typically take it out of whatever state it was in to begin with. 
# Superdense Coding
Quantum teleportation tells us, roughly speaking, that "2 classical bits + an entangled pair = 1 qubit". Superdense coding then tells us that "1 qubit + an entangled pair = 2 classical bits". 

Alice and Bob start with a pair of qubits in the entangled state $\frac{\ket{00} + \ket{11}}{\sqrt{2}}$, one of the Bell states. Recall that the [[Basic Quantum Mechanics#Systems of Qubits |Bell states]] 
$$\ket{\beta_{00}} = \frac{1}{\sqrt{2}}(\ket{00} + \ket{11})$$
$$\ket{\beta_{01}} = \frac{1}{\sqrt{2}}(\ket{01} + \ket{10})$$
$$\ket{\beta_{10}} = \frac{1}{\sqrt{2}}(\ket{00} - \ket{11})$$
$$\ket{\beta_{11}} = \frac{1}{\sqrt{2}}(\ket{01} - \ket{10})$$
form an orthonormal basis for the state space of a system of 2 qubits. Using only operations on her qubit, Alice can change the state of the overall system to any of the four Bell states. Doing nothing of course gives $\ket{\beta_{00}}$. Applying $X$ to her qubit changes $\ket{00}$ to $\ket{10}$ and $\ket{11}$ to $\ket{01}$, transforming $\ket{\beta_{00}}$ into $\ket{\beta_{01}}$. Applying $Z$ leaves $\ket{00}$ unchanged and flips the phase of $\ket{11}$, giving $\ket{\beta_{10}}$. Applying $X$ and then $Z$ gives $\ket{\beta_{01}}$ with a relative phase flip, and that's just $\ket{\beta_{11}}$. 

Once that's done, if Alice sends her qubit to Bob, he can then measure the pair in the Bell basis and know exactly which of the four operations Alice did. Thus by choosing an operation to apply--nothing for $00$, $X$ for $01$, $Z$ for $10$, and $ZX$ for $11$--Alice can determine what Bob will measure once he receives her qubit, and so can send a 2-bit string to Bob.

Note that Alice sending her half of the pair is necessary to communicate anything. No matter what operation she does on her qubit, the measurement statistics of Bob's half won't change. 

The same is true if someone only has Alice's half of the pair, which leads to the observation that superdense coding is, in some sense, secure against attacks on the channel used to send Alice's qubit. That is, a measurement on Alice's qubit alone gains no information about what bits are being sent. More precisely, suppose Eve intercepts Alice's qubits and performs any measurement on it; such a measurement can be represented as $E \otimes I$ where $E$ is some positive operator. In the $00$ state Alice gets, up to a normalization factor, $(\bra{00} + \bra{11})E \otimes I(\ket{00} + \ket{11}) = \bra{00}E \otimes I \ket{00} + \bra{11}E \otimes I \ket{11} = \bra{0}E\ket{0} + \bra{1}E\ket{1}$. In the $01$ state it's $(\bra{01} + \bra{10})E \otimes I(\ket{01} + \ket{10}) = \bra{01}E \otimes I\ket{01} + \bra{10} E \otimes I \ket{10} = \bra{0}E\ket{0} + \bra{1}E\ket{1}$. In the 10 state it might seem like the phase flip might change things, but it works out to $(\bra{00} - \bra{11})E \otimes I(\ket{00} - \ket{11}) = \bra{00}E \otimes I \ket{00} + (-\bra{11})E \otimes I (-\ket{11}) = \bra{00}E \otimes I \ket{00} + (-1)^2\bra{11}E \otimes I \ket{11}$ = $\bra{0}E\ket{0} + \bra{1}E\ket{1}$. The last state works out the same. Thus Eve's measurement results do not depend on which state was sent. 