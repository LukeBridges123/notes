The *binomial coefficients*, so named because they show up in binomial expansions (see The Binomial Theorem below), are numbers of the form n! / (k! * (n-k)!), where n and k are nonnegative integers. Any given binomial coefficient is denoted (n k) or "n choose k", the latter because (n k) is the number of ways to choose a k-item subset from an n-item set (see [Enumeration rules](Enumeration%20rules.md)). 

## Pascal's Triangle and Pascal's Identity
Let $\binom{n}{k}$ be the number of k-element subsets of $[n]$ (or more generally any n-element set). Then for any natural numbers $n, k$, we have $\binom{n+1}{k+1} = \binom{n}{k} + \binom{n}{k+1}$. Proof: a subset of $[n+1]$ either contains $n+1$ or doesn't; there are $\binom{n}{k}$ subsets that do (since, to form such a subset, we can add n+1 and then fill out the remaining k elements with a k-element subset of $[n]$) and $\binom{n}{k+1}$ subsets that don't (since, to form such a subset, we just choose k+1 elements from $[n]$). This gives the rule generating Pascal's Triangle, i.e. each entry (except for the entries on the border) is the sum of the entries above.
		1  1
	 1   2   1
   1   3   3   1
 1   4   6   4   1
1  5  10  10  5  1
## The Binomial Theorem
Besides their importance for combinatorics, the binomial coefficients are used in the binomial expansion: that is, the expansion of expressions of the form $(a + b)^n$, where n is a natural number. So, for example, $(a + b)^2 = a^2 + 2ab + b^2$, and $(a + b)^3 = a^3 + 3a^2b + 3ab^2 + b^3$. The coefficients on these expressions are the numbers in the second and third rows of Pascal's Triangle, respectively. Generalizing this, we might say that:
$(a + b)^n = \sum_{i=0}^n \binom{n}{i}a^{n-i}b^i$ 
### Combinatorial Proof 1
Each uncollected term of the expansion of $(a+b)(a+b)...(a+b)$ can be thought of as some string of a's and b's, with all such strings showing up somewhere in the expansion if you expand using the distributive law. (To see this more clearly, think of it inductively: the expansion for n = 2 is (a+b)(a+b) = a(a+b) + b(a+b) = aa + ab + ba + bb, multiplying all that by (a+b) gets all length-3 strings of a's and b's by appending an a or b to each of the length-2 strings, and so on.) Thus each term can be thought of as consisting of n "slots" to be filled with an a or b, with the $a^kb^{n-k}$ terms corresponding to the strings where exactly k "slots" have been filled with an a. There are $\binom{n}{k}$ ways to fill k of the slots with an a, thus $\binom{n}{k}$ of the $a^kb^{n-k}$ terms for any k. 
### Inductive Proof
It can also be proven inductively with Pascal's Identity and a lot of sum manipulation. Certainly it holds for n=1, and as shown above, for n=2 and n=3. Now for the induction step, suppose it holds for n. Note that $(a+b)^{n+1} = (a+b) * (a+b)^n$, so by hypothesis, $(a+b)^{n+1} = (a + b) * \sum_{i=0}^n \binom{n}{i} a^{n-i} b^i  = a * \sum_{i=0}^n \binom{n}{i} a^{n-i} b^i  + b *  \sum_{i=0}^n \binom{n}{i} a^{n-i} b^i$ = $\sum_{i=0}^n \binom{n}{i}a^{n-i+1} b^i + \sum_{j=0}^n \binom{n}{j}a^{n-j}b^{j+1}$. Taking out the first term of that first sum, and changing the starting index to match with the removal, we get $a^{n+1} + \sum_{i=1}^n\binom{n}{i} a^{n-i+1}b^i$. Taking out the last term of the second sum, and messing around a bit with j (so as to make it line up better with the first sum), we get $b^{n+1} + \sum_{j=1}^n \binom{n}{j-1}a^{n-j+1} b^j$. Combining these first and second sums, we get:
$a^{n+1} + (\sum_{i=1}^n \binom{n}{i}a^{n-i+1} b^i) + (\sum_{j=1}^n \binom{n}{j-1} a^{n-j+1} b^j) + b^{n+1}$ 
or:
$a^{n+1} + (\sum_{i=1}^n (\binom{n}{i}  + \binom{n}{i-1})a^{n-i+1}b^i) + b^{n+1}$
Using Pascal's Identity to sum the coefficients gets:
$a^{n+1} + (\sum_{i=1}^n \binom{n+1}{i}a^{n-i+1}b^i) + b^{n+1}$ 
And finally, bringing the first and last terms back into the sum, and making the needed changes to the start and end points of the sum, gets:
$\sum_{i=0}^{n+1}\binom{n+1}{i}a^{n+1 - i}b^i$, as desired.
### Note: Binomial Theorem in Rings
The above two proofs rely on only a few properties of addition and multiplication, really just that multiplication distributes over addition and that $ab = ba$. So in fact the proof goes through in any commutative ring, once you've defined multiplication of ring elements by integers as repeated addition and exponentiation to integer powers as repeated multiplication. Even in noncommutative rings it holds for pairs of elements that commute. So in particular, in any ring with a multiplicative identity, the special case $(1+x)^n = \sum_{k=0}^n \binom{n}{k}x^k$ holds for arbitrary x. The other proofs below rely more on specific properties of the real numbers, or in some cases integers, and so don't carry through (even if the result does). 
### Combinatorial Proof 2
Suppose you have $n$ objects, each which can be colored in one of $x$ shades of blue or one of $y$ shades of red. Then on one hand there are $(x+y)^n$ total colorings (n independent choices, each with $x+y$ possible options). On the other hand, we can break into cases based on the number of objects which get painted blue. There are $\binom{n}{k}x^ky^{n-k}$ colorings with $k$ blue objects ($\binom{n}{k}$ ways to choose which objects get painted blue, $x^k$ ways to paint them, $y^{n-k}$ ways to paint the rest), and summing over all $k$ gets $\sum_{k=0}^n\binom{n}{k}x^ky^{n-k}$. Thus $(x+y)^n = \sum_{k=0}^n\binom{n}{k}x^ky^{n-k}$, as desired. 

This assumes that $x$ and $y$ are both integers. When one of $x$ and $y$ is fixed, the resulting special case can then be proven for all real $x$ using a Lagrange interpolation argument. 
### Proof with Ordinary Generating Functions
Let $F_n(x)$ be the ordinary generating function for $\binom{n}{k}$ with fixed $n$ and varying $k$, i.e. $\sum_k \binom{n}{k}x^k$. Certainly $F_1(x) = 1 + x$. We can then use Pascal's identity to get a recurrence for $F_n(x)$. Since $\binom{n+1}{k} = \binom{n}{k} + \binom{n}{k-1}$, we have $F_{n+1}(x) = F_n(x) + xF_n(x) = (1+x)F_n$. Then a very simple induction gives the solution $F_n(x) = (1+x)^n$. 
### Proof with Exponential Generating Functions
For any real numbers $x$ and $y$, $e^{(x+y)t} = \sum_n \frac{(x+y)^n}{n!}t^n$, so this is the egf of $(x+y)^n$. But also, $e^{(x+y)t} = e^{xt}e^{yt}$, and using the product rule for egfs, this equals $\sum_n (\sum_{k=0}^n \binom{n}{k}x^ky^{n-k})t^n$. So, by equating the coefficients on $t^n$, we get $(x+y)^n = \sum_{k=0}^n\binom{n}{k}x^ky^{n-k}$. 
## Binomial Identities
### Sum of a Row = 2^n
Theorem: $\sum_{k=0}^n \binom{n}{k} = 2^n$. Combinatorial proof: the right-hand side counts all the subsets of $[n]$, while the left-hand side does the same by counting the number of k-element subsets for each valid k and then summing them up. Algebraic proof: in the binomial theorem, set a = b = 1. 
### "Hockey-stick" identity
Notice that, in Pascal's triangle, the downward-left diagonal starting with "1, 3, ..." actually contains all the triangular numbers. In particular, the triangular number 1 + ... + n is just below and to the right of n. In other words, $\binom{1}{1} + \binom{2}{1} + ... + \binom{n}{1} = \binom{n+1}{2}$. The more general theorem is true: $\binom{k}{k} + \binom{k+1}{k} + ... + \binom{n}{k} = \binom{n+1}{k+1}$. (The name comes from the fact that if, in Pascal's Triangle, you draw a loop around all the terms on the left-hand side of that identity, then draw another loop around $\binom{n}{k}$ and $\binom{n+1}{k+1}$, you'll get an L-shape.) Proof: the right-hand side just counts the k+1 element subsets of [n+1]; the left-hand side does the same, but splits it up into disjoint cases based on what the largest element is. E.g. the first term ($\binom{k}{k}$, which is 1) corresponds to the fact that there's only one k+1 element subset where the largest element is k+1 (i.e. {1, 2, ... k+1}); the second term counts the subsets where the largest element is k+2 (since those consist of k+2 plus k other elements chosen from [k+1], and there are $\binom{k+1}{k}$ ways to do that); and so on, with the last term corresponding to the subsets where n+1 is the largest term (choose n+1, then choose k others from [n]). These cases are exhaustive and disjoint, so one can just sum them up to get the total number of k+1 element subsets of [n+1], i.e. $\binom{n+1}{k+1}$. 
### Absorption-extraction identity and variant
Statement: $k\binom{n}{k} = n\binom{n-1}{k-1}$; alternatively, $\binom{n}{k} = \frac{n}{k}\binom{n-1}{k-1}$. Proof: both sides count the number of ways to choose a k-member group from a set of n people, with one member of the group chosen as the leader. The left-hand side represents doing this by choosing a group of k people from the n and then choosing a leader from those k; the right-hand side represents choosing a leader from all n of the people, then "rounding out" the group with k-1 chosen from the remaining n-1. 

A generalization of the above is as follows: $\sum_{k=1}^n k\binom{n}{k} = n2^{n-1}$.  
### Vandermonde's Identity
Statement of the identity: $\binom{m+n}{k} = \sum_{i = 0}^k \binom{m}{i}\binom{n}{k-i}$. Combinatorial proof: the LHS counts the number of k-element subsets of an $m+n$ element set--say, the union of the disjoint sets $M = \{a_1, ... a_m\}, N = \{b_1, ... b_n\}$. The RHS does the same, conditioned on how many elements of the subset are from $M$ and how many are from $N$--for any fixed $i$ with $0 \leq i \leq k$, the number of k-element subsets of $M \cup N$ with $i$ elements from $M$ and $k - i$ elements from $N$ is $\binom{m}{i}\binom{n}{k-i}$, and summing over the (disjoint and exhaustive) cases of all reasonable values of $i$ gets the RHS. 

Proof by generating functions: we know from the binomial theorem that $(x+1)^{m+n} = \sum_{k}^{m+n} \binom{m+n}{k}x^k$. But also, $(x+1)^{m+n} = (x+1)^m(x+1)^n = (\sum_k\binom{m}{k}x^k)(\sum_i\binom{n}{i}x^i)$. Before going further, a digression: polynomial (and power-series) multiplication can be naturally represented in terms of convolutions of coefficients. Consider $(a_0 + a_1x + a_2x^2 ...) * (b_0 + b_1x + b_2x^2 + ...)$. We know that there will be only one constant term $a_0b_0$. A linear term can be made by $a_0b_1x$ or $a_1b_0x$, thus the linear term in the product will be $(a_0b_1 + a_1b_0)x$. Similarly the quadratic terms will be $a_0b_2x^2, a_1xb_1x, a_2x^2b_0$, which combine to $(a_0b_2 + a_1b_1 + b_0a_2)x^2$. The generalization is clear: the coefficient of $x^n$ in the product will be $\sum_i^n a_ib_{n-i}$. Returning to the product $(\sum_k\binom{m}{k}x^k)(\sum_i\binom{n}{i}x^i)$, we can set $a_k = \binom{m}{k}, b_k = \binom{n}{k}$. Then using the formula derived earlier, the coefficient on $x^k$ in this product will be $\sum_i^k \binom{m}{i}\binom{n}{k-i}$. Thus $(\sum_k\binom{m}{k}x^k)(\sum_i\binom{n}{i}x^i) = \sum_{k=0}^{m+n}(\sum_i^k \binom{m}{i}\binom{n}{k-i})x^k$. This means that $\sum_{k=0}^{m+n}(\sum_i^k \binom{m}{i}\binom{n}{k-i})x^k = \sum_k^{m+n}\binom{m+n}{k}x^k$. Since two polynomials are equal iff their coefficients are equal, we then have $\binom{m+n}{k} = \sum_i^k\binom{m}{i}\binom{n}{k-i}$. 

### Rows of Pascal's Triangle are Unimodal
N.B. in definition of unimodal recall that constant and monotonically decreasing/increasing sequences still count.
## Multinomial Theorem
Let $a_1, a_2, ... a_m$ be nonnegative integers summing to n. Then $\binom{n}{a_1, a_2, ... a_m}$ is defined to be $\frac{n!}{a_1!a_2!\cdot\cdot\cdot a_m!}$. Note that the binomial coefficients are a special case of this: when there are only 2 $a_i$'s, for them to sum to n, we must have $a_1 = k, a_2 = n - k$ for some k. Combinatorial interpretation of these discussed elsewhere. 

Theorem: $(x_1 + x_2 + ... + x_m)^n = \sum_{a_1 + ... + a_m = n}

Note $\binom{n}{a_1,a_2,...a_m} = \binom{n}{a_1}\binom{n-a_1}{a_2}...\binom{n-a_1-a_2-...-a_{m-1}}{a_m}$ 

## General Binomial Theorem
The binomial theorem can be extended to cases where the exponent is any real number. First, extend the definition of the binomial coefficient: define $\binom{\alpha}{0} = 1, \binom{\alpha}{k} = \frac{\alpha(\alpha - 1)...(\alpha - k + 1)}{k!}$ for any real number $\alpha$ and positive integer k. This is exactly equivalent to the usual definition when $\alpha$ is a positive integer. Then we can state: for any $\alpha \in \mathbb{R}$, $(1+x)^\alpha = \sum_{n \geq 0}\binom{\alpha}{n}x^n$. Note that this sum is infinite unless $\alpha$ is a nonnegative integer. This is because if $\alpha$ is a nonnegative integer, the product $\alpha(\alpha-1)...(\alpha-k+1)$ includes a 0 for some k (and thus for all k larger than that, meaning that all terms beyond a certain point are 0). Also note that, in a combinatorial context, we generally aren't concerned about convergence -- we treat power series as simply "formal" power series. But in this case, the series really does converge. 

Proof: just bash away with Taylor's theorem, finding the power series at x = 0. 

### Some power series manipulations
Ex: find the power series expansion of $\sqrt{1 - 4x}$. By the general binomial theorem, this is just $\sum_{n \geq 0}\binom{1/2}{n}(-4x)^n$. Some early terms are $\binom{1/2}{0} - \binom{1/2}{1}4x = 1 - 2x$. As for the terms with $n \geq 2$, note that we have $\binom{1/2}{n} = \frac{(1/2)(1/2 - 1)...(1/2 - n +1)}{n!} = \frac{}{n!}$

## Binomial Inversion
An example: we know $3^n = \sum_{k=1}^n\binom{n}{k}2^k$, by plugging (2+1)^n into the binomial theorem. Similarly, $2^n = \sum_{k=1}^n\binom{n}{k}3^k(-1)^{n-k}$, by plugging (3-1)^n into the binomial theorem. Also: let n, j be natural numbers. Then $\sum_k\binom{n}{k}\binom{k}{j}(-1)^k = (-1)^n\delta_{nj}$, where $\delta_{mj}$ is the "Dirac delta function", equal to 1 if m = j and 0 otherwise. Algebraic proof: we'd like to eliminate that product of binomial coefficients. Recall a variant of the absorption-extraction identity: $\binom{n}{k}\binom{k}{j} = \binom{n}{j}\binom{n-j}{k-j}$ (think about committees and subcommittees). So we get $\binom{n}{j}\sum_k\binom{n-j}{k-j}(-1)^k$. That alternating sum is the alternating sum across a row of Pascal's triangle, which is 0 except on the top row where it's 1. Thus the sum is 0 unless n = j, in which case $\binom{n}{j} = 1$ and the sum itself is (-1)^n. Finish off the proof later. Or a combinatorial proof: (replacing j with m). Let n, m be nonnegative. Let E be the set of all ordered pairs (T, S) where $T \subseteq S \subseteq [n]$, $|T| = m$, and S contains an even number of elements. So if $|S| = k$ is even, then $|E| = \sum_k\binom{n}{k}\binom{k}{m}$, summing over all even k (n choose k ways to choose the elements of S, then k choose m ways to choose the elements of T subject to the given constraints). Similarly, let O be the set of all pairs (T, S) fitting all the constraints except that S has an odd number of elements; then $|O| = \sum_k\binom{n}{k}\binom{k}{m}$ summing over all odd k. If n < m then the RHS is 0 and both E and O are empty, so both sums are 0. If n = m and n is even, then k = m also, and E contains only one ordered pair $([n], [n])$. Thus the LHS is equal to 1 due to the sizes of E and O, while the RHS is equal to 1 by definition of delta function and evenness of n. If n = m and n is odd, then k = m again, size of E is 0, size of O is 1, and everything is flipped. Finally, if n > m, the RHS is certainly 0, and we can show the LHS is 0 by bijecting E and O. Let x be the largest element in $[n]$ that is not in T; let $S \Delta \{x\}$ be the "symmetric difference" (like XOR) of S and {x}: all the elements which are in one or the other but not both. Let A = E U O, i be the function A -> A defined by i((T, S)) = (T, S $\Delta$ {x}). Show later that this is a well-defined function. i has an inverse; in fact it is its own inverse since (A xor B) xor B is A. Because it's invertible it's a bijection. It has no fixed points; in fact it always switches the parity of the cardinality of S. So it maps E to O and vice versa, proving that $|E| = |O|$ and the sum on the LHS is 0. 

Another ex: explicit formula for Stirling numbers, $\sum_{k=0}^m\binom{m}{k}k^n(-1)^k = (-1)^mm!S(n, m)$. Proof: LHS = $\sum_{k=0}^m\binom{m}{k}(-1)^k\sum_jS(n, j)(k)_j$ (using the falling factorial identity on k^n). Then we can interchange the sums: $\sum_jS(n, j)j!\sum_k\binom{m}{k}\binom{k}{j}(-1)^k$ (replacing the k falling factorial j with $\binom{k}{j}j!$ and taking out the j!). Applying the Dirac delta identity from above gets $\sum_jS(m, j)j!\delta_{mj}(-1)^m$. The only nonzero term is when m = j, leaving $S(n, m)m!(-1)^m$. 

General thm: binomial inversion. Let $a_n, b_n$ be sequences. They are related by $a_n = \sum_{k=0}^n\binom{n}{k}b_k$ if and only if $b_n = \sum_{k=0}^n\binom{n}{k}a_k(-1)^{n-k}$. There's also a "symmetric" version: $a_n = \sum_{k=0}^n\binom{n}{k}(-1)^k$ iff $b_n = \sum_{k=0}^n\binom{n}{k}(-1)^k$. (indexes wrong a bit?) Proof of "asymmetric" version: suppose the second of the two identities, with $b_n$ on the LHS, holds; then $\sum_{k=0}^n\binom{n}{k}b_k = \sum_k\binom{n}{k}\sum_j\binom{k}{j}a_j(-1)^{k-j}$. Interchange summation: $\sum_ja_j\sum_k\binom{n}{k}\binom{k}{j}(-1)^{k-j}$. That inner sum equals $(-1)^n\delta_{jn}$ by an identity above (since we can multiply both sides by (-1)^n, fill in later). Only nonzero when n = j so the sum is just $a_n$. 

Application: derangements. How many permutations of $[n]$ have no fixed points? Let D(n, k) denote the number of permutations of $[n]$ with k fixed points. So by brute-force computation, D(4, 4) = 1, D(4, 3) = 0, D(4, 2) = 6, D(4, 1) = 8, and D(4, 0) = 9; 9/25 of the permutations are derangements. 

Deriving an explicit formula for the number of derangements: If k elements are fixed points, then the remaining n-k are "deranged". Thus D(n, k) = $\binom{n}{k}D(n-k, 0)$: choose k elements to be fixed points, then apply a derangement to the rest. Since a permutation may have anywhere from 0 to n fixed points, we can say that $n! = \sum_k D(n, k) = \sum_k\binom{n}{k}D(n-k, 0)$. We can further change this to $\sum_k\binom{n}{n-k}D(k, 0)$ (swapping the indices, so to speak), and then $\binom{n}{n-k} = \binom{n}{k}$. So in fact $n! = \sum_k\binom{n}{k}D(k, 0)$. By binomial inversion, we know $D(n, 0) = \sum_k \binom{n}{k}k!(-1)^{n-k}$. This then gives a formula for the number of derangements of n. (N.B. D(n, 0) is also sometimes denoted $!n$, or "n subfactorial".) Follow-up question: find the limit of $\frac{!n}{n!}$ as n goes to infinity; this is the limit as n goes to infinity of $\frac{1}{n!}\sum_k\frac{n!}{k!(n-k)!}(-1)^{n-k}k!$. The $n!$ and $k!$ cancel so we get $\sum_k\frac{-1^{n-k}}{n-k!} = \sum_{n=0}^\infty\frac{(-1)^n}{n!} = e^{-1} = \frac{1}{e}$. Thus this is the limit, as n gets larger and larger, of the probability that a randomly chosen permutation will be a derangement. 

Another ex. Finding a closed form for $\sum_k\binom{n}{k}(-1)^k\frac{2^k}{k+1}$. First use the absorption-extraction identity: $\binom{n+1}{k+1} = \frac{n+1}{k+1}\binom{n}{k}$. Thus we can replace $\binom{n}{k}\frac{1}{k+1}$ with $\binom{n+1}{k+1}\frac{1}{n+1}$. The sum becomes $\frac{1}{n+1}\sum_k\binom{n+1}{k+1}(-1)^k2^k$. For convenience, combine (-1)^k and 2^k, and replace with $\frac{-2^{k+1}}{-2}$ to make the exponent match up with the bottom index in the binomial coefficient

### Binomial Transform
